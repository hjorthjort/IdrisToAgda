% CREATED BY DAVID FRISK, 2015
\chapter{Introduction}

% The paradigm is actually orthogonal to the type system.
Writing correct software is hard. Over the years several methods and languages
have been developed to make it easier. Types allow the compiler to check some
properties about a program before run-time. More advanced type systems allow
more complicated properties be checked.
One advanced types system is dependent types. It is the subject of plenty
of research.

Dependently typed programming languages, however, are far from mainstream.
There are many factors which hinders adoption. One is community fragmentation.
The dependently typed community, is split between several languages.
Idris, Agda, ATS, F* and Epigram are some of the most used.

A common obstacle for adoption of a new programming language is the
availability of quality libraries. Productive application development requires
many different libraries.  For example, network protocols, parser combinators
and cryptography.  Implementing all common libraries is a huge task.  There is
a lot of duplicated effort when every language needs to implement similar
libraries.  If it would be possible to re-use libraries between languages,
language implementers could focus on developing their language.
% instead of writing the same libraries over and over for every new language.

% Patrik: Good paragraph
Agda~\cite{agda} and Idris~\cite{idris} are two of the most used dependently
typed programming languages.
The Idris website states that Idris is inspired
by Agda but with more focus on practical
programming.\footnote{\url{http://docs.idris-lang.org/en/latest/faq/faq.html\#what-are-the-differences-between-agda-and-idris}}
Agda's main focus is on interactive theorem proving, though it is used as
a general purpose programming language as well.
However, while they have different focus, both languages share most of their features and their type systems are similar.

We wish to investigate if it is possible to construct a source-to-source
compiler from Idris to Agda. The source-to-source compiler, from here on called
transpiler, should handle a common subset of Idris and Agda.  The transpiler
would allow Idris libraries to be reused in Agda. This would increase the
number of available Agda libraries and increase the audience for every new
Idris library.

Dependent types allow for all propositions in predicate logic to be encoded as
types. A program which type-checks is a proof of the proposition encoded in
its type signature. A dependently type programming language is also a theorem
prover. If the transpiler is correct and verified it can be used to increase
the confidence of theorems. A proof which is valid in both languages is
stronger than one which is only valid in one language.


% Gather everything about the goals in this section.
% \subsection{Goals}
The goal of this project is to construct a transpiler which can translate
a subset of Idris into valid Agda. The transpiler is intended as an aid to
a human programmer which adapts and Idris library for use in Agda.  It is not
intended as a automatic compiler which runs Idris programs using the Agda
runtime. Therefore we will leave untranslatable parts as holes for the user to
manually specify. This also means we aim to produce output which is easy for
the human user to understand.

% Expand
% Since dependently typed programming is often used for formal proofs it is
% important that the user can understand the program.

% The language features which are
% not yet implemented will be left as holes to allow the user to provide the
% missing parts.

The transpiler should preserve the semantics of the translated program.
Otherwise it would not be a useful tool.  We will verify that the transpiler
preserves the program semantics.  However, this is hard to do formally,
especially with an incomplete transpiler.  The verification will be done as far
as possible.

% SOMEWHAT DONE Patrik:
% Could mention [here or later] the relation to refactoring: the translation
% can be seen as divided into two phases where the first phase is an Idris ->
% Idris refactoring [which should be possible to verify within Idris] and the
% second phase is the "refactored Idris" -> Agda part [which is harder to
% verify].

% TODO Det har ar inte sant. Skriv hur `ita` faktiskt ar uppbyggd.
The transpiler could be seen as divided into two passes. First, a Idris to
Idris refactoring to resolve syntactic sugar and gather information from the
type-checker into the AST. The second pass is the Idris to Agda translation.
The first pass should be possible to verify within Idris. The second pass is
harder to verify.



\subsection{Scope}

It is not feasible to correctly translate between 100\% of the
languages in the scope of a master's thesis.  The languages are not the same,
so we will not work on features only present in Idris or Agda.  Only
transpiling from Idris to Agda will be considered. Bidirectional transpiling is
a interesting goal for further projects.

% TODO Skriv vad jag faktiskt hanterar och vad som inte ar gjort och vad som ar
% halvags

There will not be any consideration for run-time characteristics of the
translated program.
Thus an efficient Idris program may well be translated into a slow Agda program.

We will target Idris 1.3.1 and Agda 2.6.0.

